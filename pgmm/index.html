<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PostgreSQL Query Plan Visualizer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <script defer src="main.js"></script>
    <style>
      /* Dark theme */
      body {
        background-color: #111827;
        color: #f3f4f6;
        font-family:
          system-ui,
          -apple-system,
          sans-serif;
        margin: 0;
        padding: 1rem;
      }

      .container {
        max-width: 64rem;
        margin: 0 auto;
      }

      .card {
        background-color: #1f2937;
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin-top: 1rem;
      }

      .input-group {
        margin-bottom: 1rem;
      }

      textarea {
        width: 100%;
        padding: 0.5rem;
        margin-top: 0.5rem;
        background-color: #111827;
        color: #f3f4f6;
        border: 1px solid #374151;
        border-radius: 0.375rem;
        font-family: monospace;
        resize: vertical;
      }

      textarea.query-plan {
        height: 12rem;
      }

      textarea.explain {
        height: 8rem;
      }

      button {
        width: 100%;
        padding: 0.5rem;
        background-color: #2563eb;
        color: white;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        font-size: 1rem;
      }

      button:hover {
        background-color: #1d4ed8;
      }

      button:disabled {
        background-color: #6b7280;
        cursor: not-allowed;
      }

      .error {
        background-color: #7f1d1d;
        color: #fee2e2;
        padding: 1rem;
        border-radius: 0.375rem;
        margin: 1rem 0;
      }

      .diagram-container {
        background-color: #111827;
        padding: 1rem;
        border-radius: 0.375rem;
        margin-top: 1rem;
        overflow-x: auto;
      }

      .code-view {
        margin-top: 1rem;
      }

      .code-view summary {
        cursor: pointer;
        color: #d1d5db;
      }

      .code-view summary:hover {
        color: #f3f4f6;
      }

      .code-view pre {
        background-color: #111827;
        padding: 1rem;
        border-radius: 0.375rem;
        border: 1px solid #374151;
        overflow-x: auto;
        margin-top: 0.5rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <h1>PostgreSQL Query Plan Visualizer</h1>

        <div class="input-group">
          <label for="queryPlan">Query Plan JSON (EXPLAIN FORMAT JSON)</label>
          <textarea
            id="queryPlan"
            class="query-plan"
            placeholder="Paste your query plan JSON here..."
          ></textarea>
        </div>

        <div class="input-group">
          <label for="explainAnalyze">EXPLAIN ANALYZE Output (Optional)</label>
          <textarea
            id="explainAnalyze"
            class="explain"
            placeholder="Paste your EXPLAIN ANALYZE output here (optional)..."
          ></textarea>
        </div>

        <div id="error" class="error" style="display: none"></div>

        <button id="visualize" disabled>Visualize Query Plan</button>

        <div id="diagramOutput" class="diagram-container" style="display: none">
          <div id="mermaidDiagram"></div>

          <details class="code-view">
            <summary>Show Raw Mermaid Code</summary>
            <pre id="rawMermaid"></pre>
          </details>
        </div>
      </div>
    </div>
  </body>
</html>
